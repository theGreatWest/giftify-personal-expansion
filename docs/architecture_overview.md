# 🏗 Giftify Architecture Overview

**Giftify**는 *친구의 위시리스트를 기반으로 펀딩이 가능한 이커머스 서비스*로,  
일반 결제와 펀딩 결제가 공존하며 결제 이후 정산까지 이어지는 **복합적인 도메인 흐름**을 가지고 있습니다.

또한 단순 CRUD 중심의 서비스가 아니라,  
회원 · 위시리스트 · 펀딩 · 결제 정보를 **조합하여 조회하는 요구사항**이 많아  
쓰기(Command)와 조회(Read)의 성격이 명확히 구분되는 특징을 가집니다.

본 프로젝트는 이러한 특성을 반영하여  
**단일 JVM 기반 멀티모듈(Multi-Module) 아키텍처**를 채택하였습니다.

---

## 🔹 단일 JVM 멀티모듈 구조를 선택한 이유

Giftify는 개인 프로젝트이자 초기 서비스 단계로,  
초기부터 MSA를 도입할 경우 **운영·배포·테스트 복잡도가 과도하게 증가**할 수 있다고 판단했습니다.

이에 따라 다음과 같은 이유로 단일 JVM 멀티모듈 구조를 선택했습니다.

- **운영 안정성 확보**  
  단일 애플리케이션 배포를 통해 환경 구성과 장애 대응을 단순화
- **도메인 중심 설계 강화**  
  기술 계층이 아닌 *비즈니스 도메인 기준*으로 모듈을 분리
- **변경 영향 최소화**  
  정책 변경 가능성이 높은 결제·펀딩·정산 도메인을 독립 모듈로 관리
- **MSA 전환을 고려한 구조적 준비**  
  트래픽 증가 또는 도메인 확장 시, 모듈 단위로 서비스 분리가 가능하도록 설계

이를 통해 **모놀리식의 단순함**과 **MSA로의 확장 가능성**을 동시에 확보했습니다.

---

## 🔹 모듈 분리 기준

모듈은 다음 기준을 바탕으로 분리되었습니다.

- 하나의 모듈은 **하나의 핵심 책임만 담당**
- 도메인 간 직접 의존을 최소화하고, 인터페이스 기반으로 협력
- 결제·펀딩·정산과 같이 **정책 변화 가능성이 높은 영역은 독립 모듈로 분리**
- 조회 성격이 강한 기능은 쓰기 도메인과 분리하여 관리

---

## 🔹 모듈 구성 및 역할

### 1️⃣ com-module (실행 모듈)

**애플리케이션 실행 진입점 역할을 담당하는 모듈**입니다.

**주요 역할**
- Spring Boot Application 실행
- 전체 모듈 조합 및 의존성 관리
- 공통 설정 및 환경(Profile) 구성

> 📌 비즈니스 로직을 포함하지 않으며,  
> 애플리케이션을 조립하고 실행하는 책임만 가집니다.

---

### 2️⃣ core-module (핵심 도메인)

**Giftify의 핵심 비즈니스 규칙을 정의하는 중심 도메인 모듈**입니다.

**포함 도메인**
- 회원(Member)
- 친구 관계(Friend)
- 위시리스트(Wishlist)
- 펀딩 가능 조건 및 핵심 정책 검증

> 📌 “펀딩은 친구의 위시리스트에 있는 항목만 가능하다”와 같은  
> Giftify의 핵심 도메인 규칙이 이 모듈에 위치합니다.

---

### 3️⃣ funding-module (펀딩 도메인)

**Giftify의 차별화 요소인 펀딩 비즈니스 흐름을 담당하는 전용 모듈**입니다.

**포함 도메인**
- 펀딩 생성 및 참여
- 목표 금액 / 진행 상태 관리
- 펀딩 마감 및 성공·실패 처리
- 펀딩 조건 검증 로직

> 📌 일반 상품 구매와는 전혀 다른 생명주기를 가지므로  
> 결제 모듈과 분리하여 도메인 복잡도를 낮췄습니다.

---

### 4️⃣ payment-module (결제 도메인)

**금전 거래를 책임지는 결제 전용 모듈**입니다.

**포함 도메인**
- 일반 결제 처리
- 펀딩 결제 처리 (결제 유형 분기)
- 결제 상태 관리
- 결제 취소 / 실패 처리
- 외부 PG 연동 인터페이스

> 📌 “무엇을 결제하는가”가 아니라  
> “어떤 방식으로 결제되는가”에 집중하는 도메인입니다.

---

### 5️⃣ settlement-module (정산 도메인)

**결제 완료 이후의 금전 흐름을 관리하는 후행 도메인 모듈**입니다.

**포함 도메인**
- 펀딩 성공 시 정산 처리
- 수혜자(또는 판매자) 정산 금액 계산
- 정산 상태 및 이력 관리

> 📌 결제와 정산을 분리함으로써  
> 회계 정책 변경이나 정산 주기 변경 시 영향 범위를 최소화했습니다.

---

### 6️⃣ search-module (조회 전용 모듈 – Elasticsearch)

**여러 도메인의 정보를 조합하여 조회할 때만 사용되는 조회 전용 모듈**입니다.

**포함 도메인**
- 상품 / 위시리스트 / 펀딩 정보 통합 검색
- 펀딩 상태, 참여 현황 등 조건 기반 검색
- Elasticsearch Index 및 Mapping 관리
- Read Model 기반 조회 로직

> 📌 단일 도메인 조회는 각 도메인 모듈에서 처리하고,  
> **여러 도메인을 조합해야 하는 검색 시에만 search 모듈을 사용**합니다.  
> 이를 통해 불필요한 인덱스 생성과 의존성을 방지하고,  
> Command 도메인과 분리된 **부분적 CQRS 패턴**을 적용했습니다.

---

### 7️⃣ infrastructure-module (인프라 연동 모듈)

**기술 인프라 및 외부 시스템 연동 책임을 담당하는 모듈**입니다.

**포함 도메인**
- RDB 접근 구현체 (JPA / MyBatis)
- Elasticsearch Client 설정
- 외부 API 연동 (PG, 알림 등)
- 스케줄러 및 인프라 공통 설정

> 📌 도메인 로직이 특정 기술에 종속되지 않도록  
> 인프라 구현을 분리했습니다.

---

### 8️⃣ common-module (공통 모듈)

**모든 모듈에서 공통으로 사용하는 요소를 관리하는 모듈**입니다.

**포함 도메인**
- 공통 예외 및 에러 코드
- 공통 응답 객체
- BaseEntity 및 공통 유틸
- 상수, 어노테이션

---

## ✅ 결론

Giftify의 단일 JVM 멀티모듈 아키텍처는  
**펀딩형 이커머스라는 비즈니스 복잡도**를 관리하면서도  
과도한 분리를 피하고, 실제 운영과 확장을 모두 고려한 구조입니다.

도메인 책임을 명확히 분리함으로써  
**안정적인 운영**, **유연한 정책 변경**, **MSA 전환 가능성**을 동시에 확보하는 것을 목표로 합니다.